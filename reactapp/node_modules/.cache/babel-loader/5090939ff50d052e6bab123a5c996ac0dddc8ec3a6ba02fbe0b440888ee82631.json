{"ast":null,"code":"import _slicedToArray from\"/home/xkruzel/Desktop/todo/reactapp/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import*as THREE from'three';import{OrbitControls}from'three/examples/jsm/controls/OrbitControls';import*as dat from'dat.gui';import{Point}from'./Point';import{Interaction}from'three.interaction-fixed';function dec2bin(dec,n){var res=(dec>>>0).toString(2);if(res.length<n){for(var i=0;i<n-res.length;++i){res='0'+res;}}return res;}export function init3Dgraphics(canvas,div,data,nodes_ids,h,w){if(data===undefined){return false;}var CYLINDER_HEIGHT=3;var scene=new THREE.Scene();//scene.background = new THREE.Color( 0xd3d3d3 );\nscene.background=new THREE.Color(0xf8f2ea);var camera=new THREE.PerspectiveCamera(75,canvas.width/canvas.height,0.1,1000);var renderer=new THREE.WebGLRenderer({canvas:canvas});renderer.setPixelRatio(window.devicePixelRatio);renderer.setSize(canvas.width,canvas.height);// full size\ncamera.position.setZ(30);// for better perspective\nrenderer.sortObjects=false;renderer.render(scene,camera);new Interaction(renderer,scene,camera);// For showing text information about clusters\nvar texts=[];//const axesHelper = new THREE.AxesHelper(100);\n//scene.add(axesHelper);\n/*\n  const gui = new dat.GUI();\n  const options = {\n    sphereColor : 0xffea00,\n    wireframe: false,\n  };\n*/var pointLight=new THREE.PointLight(0xffffff);pointLight.position.set(20,20,20);var ambientLight=new THREE.AmbientLight(0xffffff);ambientLight.position.set(20,20,20);scene.add(pointLight,ambientLight);//const lightHelper = new THREE.PointLightHelper(pointLight);  // shows position of lighsource\n//const gridHelper = new THREE.GridHelper(30, 20);\n//scene.add(lightHelper, gridHelper);\nwindow.addEventListener('resize',function(){camera.aspect=canvas.width/canvas.height;camera.updateProjectionMatrix();renderer.setSize(canvas.width);});var controls=new OrbitControls(camera,renderer.domElement);processClusters(scene,data);data=null;function animate(){setTimeout(function(){requestAnimationFrame(animate);},1000/5);controls.update();renderer.render(scene,camera);pointLight.position.copy(camera.position);}renderer.setAnimationLoop(animate);window.addEventListener('resize',function(){camera.aspect=canvas.width/canvas.width;camera.updateProjectionMatrix();renderer.setSize(canvas.width,canvas.width);});function calcColor(max,val){return\"hsla(147, 0%, 50%, 1)\";/*\n    const min = 0\n    var minHue = 240, maxHue=0;\n    var curPercent = (val - min) / (max-min);\n    var colString = \"hsl(\" + ((curPercent * (maxHue-minHue) ) + minHue) + \",65%,50%)\";\n    return colString;\n    */}function createCylinder(data,id,startPoint,endPoint,currRadius,nextRadius,rank,rank_max){var color=new THREE.Color(data[id]['Color']===''?calcColor(rank_max,rank):data[id]['Color']);//color.setHex(rank/10 * 0xffffff );\n// color.setHex(rank/10 * 0xffffff );\nvar cylinderMesh=function cylinderMesh(startPoint,endPoint,midPoint,currRadius,nextRadius,color){/* edge from X to Y */var direction=new THREE.Vector3().subVectors(endPoint,startPoint);var orientation=new THREE.Matrix4();/* THREE.Object3D().up (=Y) default orientation for all objects */orientation.lookAt(startPoint,endPoint,new THREE.Object3D().up);/* rotation around axis X by -90 degrees \n      * matches the default orientation Y \n      * with the orientation of looking Z */var mat=new THREE.Matrix4();mat.set(1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1);orientation.multiply(mat);var geometry=new THREE.BufferGeometry().setFromPoints([new THREE.Vector3(startPoint.x,startPoint.y,startPoint.z),new THREE.Vector3(endPoint.x,endPoint.y,endPoint.z)]);var material=new THREE.LineBasicMaterial({color:0x0000ff});var line=new THREE.Line(geometry,material);scene.add(line);/* cylinder: radiusAtTop, radiusAtBottom, \n          height, radiusSegments, heightSegments */var edgeGeometry=new THREE.CylinderGeometry(currRadius,nextRadius,direction.length(),8,1);var cylinder=new THREE.Mesh(edgeGeometry,new THREE.MeshPhongMaterial({color:color,flatShading:true}));cylinder.applyMatrix4(orientation);cylinder.position.set(midPoint.x,midPoint.y,midPoint.z);console.log('cylinder ',cylinder.position);cylinder.cursor='pointer';cylinder.on('click',function(ev){texts.forEach(function(text){var selectedObject=scene.getObjectByName(text.name);scene.remove(selectedObject);});var text='';data[id][\"Nodes\"].forEach(function(elem){if(text!==''){text+=',';}text+=' (';var bin=dec2bin(elem,nodes_ids.length);for(var i=0;i<bin.length;i++){if(bin[i]==='1'){text+=' '+nodes_ids[i];}}text+=')';});div.innerHTML=text;});return cylinder;};var midPoint=new Point((startPoint.x+endPoint.x)/2,(startPoint.y+endPoint.y)/2,(startPoint.z+endPoint.z)/2);return cylinderMesh(startPoint,endPoint,midPoint,currRadius,nextRadius,color);//new THREE.Mesh(geometryCyl, material);\n}function getChildsChilds(data,cluster){var childsChildCount=0;for(var i=0;i<cluster[\"Desc\"].length;++i){childsChildCount+=data[cluster[\"Desc\"][i]][\"NodeCount\"];}return childsChildCount;}// prevPoint, point - upper and downer middle points of cylinder\n// dirPoint - point to which direction of cylinder (dir vector) should go \nfunction clustering(scene,data,id,max_branching,prevPointFirst,pointFirst,biggestRank){if(id===undefined){console.log(\"Id is undefined in clustering\");return;}function rec(current,prevPoint,point){var cluster=data[current];var childCount=cluster[\"Desc\"].length;var childsChildCount=getChildsChilds(data,cluster);var cylinder=createCylinder(data,current,prevPoint,point,cluster.NodeCount,childsChildCount,data[current][\"Rank\"],biggestRank);var prevPointPointDist=Math.sqrt((point.x-prevPoint.x)*(point.x-prevPoint.x)+(point.y-prevPoint.y)*(point.y-prevPoint.y)+(point.z-prevPoint.z)*(point.z-prevPoint.z));if(childCount===0){return[cylinder];}var result=[];var newStartPoint=new Point(point.x,point.y,point.z);// to make copy\nvar dirVector=new THREE.Vector3(point.x-prevPoint.x,point.y-prevPoint.y,point.z-prevPoint.z);var newEndPointDir=new Point(dirVector.x+point.x,dirVector.y+point.y,dirVector.z+point.z);for(var i=0;i<childCount;++i){if(childCount===1){/*            if (childsChildCount === cluster[\"Desc\"].length && childsChildCount !== 0 && data[cluster[\"Desc\"][0]][\"Desc\"].length !== 0) {\n              cylinder = undefined; // join same-like cluster to one - draw one cluster with bigger height\n              newStartPoint = new Point(prevPoint.x, prevPoint.y, prevPoint.z); // to make copy\n            }\n*/var _childrens=rec(cluster[\"Desc\"][0],newStartPoint,newEndPointDir);// array\n_childrens.push(cylinder);return _childrens;}// COMPUTE NEW COORDINATES around circle\n// const theta = 2 * Math.PI / childCount;\nvar _h=childCount/2;/*\n        var fi = i * theta;\n        if (i <= h && i % 2 === 1) {\n          fi = (Math.ceil(h) - 1 + i) * theta;\n        } else if (i > h && (childCount - 1 - i) % 2 === 0) {\n          fi = (childCount - i) * theta;\n        } if (i > h && (childCount - 1 - i) % 2 === 1) {\n          fi = (Math.ceil(h) - 1 + childCount - i) * theta;\n        }\n\n        var yPos = 0;\n        const half = Math.floor(childCount / 2);\n        if (i !== 0 && i !== half) {\n            if (i < half) {\n              yPos += (1 - cluster[\"Rank\"]/10);\n            } else {\n              yPos -= (1 - cluster[\"Rank\"]/10);\n            }\n        }\n        */var theta=2*Math.PI/childCount*i;var xPos=childsChildCount*Math.cos(theta);var zPos=childsChildCount*Math.sin(theta);var vector=new THREE.Vector3(newStartPoint.x-prevPoint.x,newStartPoint.y-prevPoint.y,newStartPoint.z-prevPoint.z).normalize();var distance=Math.sqrt(cluster.NodeCount*cluster.NodeCount+prevPointPointDist*prevPointPointDist);var newStartPointHelper=new Point(prevPoint.x+distance*vector.x,prevPoint.y+distance*vector.y,prevPoint.z+distance*vector.z);var branch_factor=2-1/max_branching;xPos=Math.cos(theta)*childsChildCount*branch_factor;zPos=Math.sin(theta)*childsChildCount*branch_factor;var newEndPoint=new Point(newStartPointHelper.x+xPos,newStartPointHelper.y-CYLINDER_HEIGHT,newStartPointHelper.z+zPos);var childrens=rec(cluster[\"Desc\"][i],newStartPoint,newEndPoint);result=result.concat(childrens);}var group=new THREE.Group();var positions={};result.forEach(function(elem){var position=elem.position;console.log(position);positions[elem]=new Point(position.x,position.y,position.z);group.add(elem);});var direction=new THREE.Vector3().subVectors(newEndPointDir,newStartPoint);var orientation=new THREE.Matrix4();/* THREE.Object3D().up (=Y) default orientation for all objects */orientation.lookAt(newStartPoint,newEndPointDir,new THREE.Object3D().up);/* rotation around axis X by -90 degrees \n      * matches the default orientation Y \n      * with the orientation of looking Z */var mat=new THREE.Matrix4();mat.set(1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1);orientation.multiply(mat);group.applyMatrix4(orientation);result.forEach(function(elem){var point=positions[elem];console.log(point);elem.position.set(point.x,point.y,point.z);});result.push(cylinder);return result;}var allObjects=rec(id,prevPointFirst,pointFirst);allObjects.forEach(function(object){scene.add(object);});}function compMaxBranching(data,key){var stack=[key];var maximums={};var colors={};while(stack.length>0){var current=stack.pop();colors[current]='G';stack.push(current);if(maximums[current]===undefined){maximums[current]=0;}var count_black=0;var desc_count=data[current][\"Desc\"].length;for(var i=0;i<desc_count;++i){if(colors[data[current][\"Desc\"][i]]===undefined){stack.push(data[current][\"Desc\"][i]);}if(colors[data[current][\"Desc\"][i]]==='B'){count_black+=1;maximums[current]=Math.max(maximums[data[current][\"Desc\"][i]],maximums[current]);}}if(count_black===desc_count){colors[current]='B';stack.pop();if(desc_count>1){maximums[current]+=1;}}}return maximums[key];}function processClusters(scene,data){var root_cluster_key=undefined;var biggestRank=0;Object.entries(data).forEach(function(_ref){var _ref2=_slicedToArray(_ref,2),k=_ref2[0],v=_ref2[1];if(v[\"Rank\"]===0){root_cluster_key=k;}biggestRank=Math.max(v[\"Rank\"],biggestRank);});var max_branching=compMaxBranching(data,root_cluster_key);var firstHeight=biggestRank*CYLINDER_HEIGHT/2+CYLINDER_HEIGHT;var firstStartPoint=new Point(0,firstHeight,0);var firstEndPoint=new Point(0,firstHeight-CYLINDER_HEIGHT,0);clustering(scene,data,root_cluster_key,max_branching,firstStartPoint,firstEndPoint,biggestRank);}}","map":{"version":3,"names":["THREE","OrbitControls","dat","Point","Interaction","dec2bin","dec","n","res","toString","length","i","init3Dgraphics","canvas","div","data","nodes_ids","h","w","undefined","CYLINDER_HEIGHT","scene","Scene","background","Color","camera","PerspectiveCamera","width","height","renderer","WebGLRenderer","setPixelRatio","window","devicePixelRatio","setSize","position","setZ","sortObjects","render","texts","pointLight","PointLight","set","ambientLight","AmbientLight","add","addEventListener","aspect","updateProjectionMatrix","controls","domElement","processClusters","animate","setTimeout","requestAnimationFrame","update","copy","setAnimationLoop","calcColor","max","val","createCylinder","id","startPoint","endPoint","currRadius","nextRadius","rank","rank_max","color","cylinderMesh","midPoint","direction","Vector3","subVectors","orientation","Matrix4","lookAt","Object3D","up","mat","multiply","geometry","BufferGeometry","setFromPoints","x","y","z","material","LineBasicMaterial","line","Line","edgeGeometry","CylinderGeometry","cylinder","Mesh","MeshPhongMaterial","flatShading","applyMatrix4","console","log","cursor","on","ev","forEach","text","selectedObject","getObjectByName","name","remove","elem","bin","innerHTML","getChildsChilds","cluster","childsChildCount","clustering","max_branching","prevPointFirst","pointFirst","biggestRank","rec","current","prevPoint","point","childCount","NodeCount","prevPointPointDist","Math","sqrt","result","newStartPoint","dirVector","newEndPointDir","childrens","push","theta","PI","xPos","cos","zPos","sin","vector","normalize","distance","newStartPointHelper","branch_factor","newEndPoint","concat","group","Group","positions","allObjects","object","compMaxBranching","key","stack","maximums","colors","pop","count_black","desc_count","root_cluster_key","Object","entries","k","v","firstHeight","firstStartPoint","firstEndPoint"],"sources":["/home/xkruzel/Desktop/todo/reactapp/src/rendering.js"],"sourcesContent":["import * as THREE from 'three';\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls';\nimport * as dat from 'dat.gui';\nimport { Point } from './Point';\nimport { Interaction } from 'three.interaction-fixed';\n\nfunction dec2bin(dec, n) {\n  var res = (dec >>> 0).toString(2);\n\n  if (res.length < n) {\n    for (let i = 0; i < (n - res.length); ++i) {\n      res = '0' + res;\n    }\n  }\n\n  return res;\n}\n\nexport function init3Dgraphics(canvas, div, data, nodes_ids, h, w) {\n\n  if (data === undefined) {\n    return false;\n  }\n\n  const CYLINDER_HEIGHT = 3;\n\n  const scene = new THREE.Scene();\n  //scene.background = new THREE.Color( 0xd3d3d3 );\n  scene.background = new THREE.Color( 0xf8f2ea);\n  const camera = new THREE.PerspectiveCamera(75, canvas.width / canvas.height, 0.1, 1000)\n  const renderer = new THREE.WebGLRenderer({\n    canvas: canvas,\n  });\n\n  renderer.setPixelRatio( window.devicePixelRatio );\n  renderer.setSize(canvas.width, canvas.height); // full size\n  camera.position.setZ(30); // for better perspective\n  renderer.sortObjects = false;\n  renderer.render(scene, camera);\n\n  new Interaction(renderer, scene, camera);\n\n// For showing text information about clusters\n  var texts = [];\n\n  //const axesHelper = new THREE.AxesHelper(100);\n  //scene.add(axesHelper);\n\n/*\n  const gui = new dat.GUI();\n  const options = {\n    sphereColor : 0xffea00,\n    wireframe: false,\n  };\n*/    \n  const pointLight = new THREE.PointLight(0xffffff)\n  pointLight.position.set(20, 20, 20);\n\n  const ambientLight = new THREE.AmbientLight(0xffffff)\n  ambientLight.position.set(20, 20, 20);\n\n  scene.add(pointLight, ambientLight);\n\n  //const lightHelper = new THREE.PointLightHelper(pointLight);  // shows position of lighsource\n  //const gridHelper = new THREE.GridHelper(30, 20);\n\n  //scene.add(lightHelper, gridHelper);\n\n  window.addEventListener('resize', function() {\n    camera.aspect = canvas.width / canvas.height;\n    camera.updateProjectionMatrix();\n    renderer.setSize(canvas.width);\n  });\n\n  const controls = new OrbitControls(camera, renderer.domElement);\n\n  processClusters(scene, data);\n  data = null;\n\n  function animate() {\n    setTimeout( function() {\n      requestAnimationFrame( animate );\n    }, 1000 / 5 );\n\n    controls.update();\n    renderer.render(scene, camera);\n    pointLight.position.copy(camera.position );\n  }\n\n  renderer.setAnimationLoop(animate);\n\n  window.addEventListener('resize', function() {\n    camera.aspect = canvas.width / canvas.width\n    camera.updateProjectionMatrix();\n    renderer.setSize(canvas.width, canvas.width);\n  });\n\n\n  function calcColor(max, val) {\n    return \"hsla(147, 0%, 50%, 1)\";\n    /*\n    const min = 0\n    var minHue = 240, maxHue=0;\n    var curPercent = (val - min) / (max-min);\n    var colString = \"hsl(\" + ((curPercent * (maxHue-minHue) ) + minHue) + \",65%,50%)\";\n    return colString;\n    */\n  }\n\n  function createCylinder( data, id, startPoint, endPoint, currRadius, nextRadius, rank, rank_max) {\n    const color = new THREE.Color( data[id]['Color'] === '' ? calcColor(rank_max, rank) : data[id]['Color'] );\n    //color.setHex(rank/10 * 0xffffff );\n   // color.setHex(rank/10 * 0xffffff );\n\n\n    var cylinderMesh = function( startPoint, endPoint, midPoint, currRadius, nextRadius, color ) {\n      /* edge from X to Y */\n      const direction = new THREE.Vector3().subVectors( endPoint, startPoint );\n\n      const orientation = new THREE.Matrix4();\n      /* THREE.Object3D().up (=Y) default orientation for all objects */\n      orientation.lookAt(startPoint, endPoint, new THREE.Object3D().up);\n\n      /* rotation around axis X by -90 degrees \n      * matches the default orientation Y \n      * with the orientation of looking Z */\n      const mat =  new THREE.Matrix4();\n      mat.set(\n        1,0,0,0,\n        0,0,1,0, \n        0,1,0,0,\n        0,0,0,1\n      );\n      orientation.multiply(mat);\n      const geometry = new THREE.BufferGeometry().setFromPoints( [  new THREE.Vector3( startPoint.x, startPoint.y, startPoint.z ), new THREE.Vector3( endPoint.x, endPoint.y, endPoint.z  )] );\n      const material = new THREE.LineBasicMaterial( { color: 0x0000ff } );\n      const line = new THREE.Line( geometry, material );\n      scene.add( line );\n\n      /* cylinder: radiusAtTop, radiusAtBottom, \n          height, radiusSegments, heightSegments */\n      const edgeGeometry = new THREE.CylinderGeometry( currRadius, nextRadius, direction.length(), 8, 1);\n      const cylinder = new THREE.Mesh( edgeGeometry, new THREE.MeshPhongMaterial( { color: color, flatShading : true } ) );\n\n      cylinder.applyMatrix4(orientation)\n      cylinder.position.set(midPoint.x, midPoint.y, midPoint.z);\n      console.log('cylinder ', cylinder.position);\n      cylinder.cursor = 'pointer';\n      cylinder.on('click', function(ev) {\n\n        texts.forEach(function (text) {\n            var selectedObject = scene.getObjectByName(text.name);\n            scene.remove( selectedObject );\n        });\n\n        var text = '';\n        data[id][\"Nodes\"].forEach(function (elem) {\n          if (text !== '') {\n            text += ',';\n          }\n          text += ' (';\n          const bin = dec2bin(elem, nodes_ids.length);\n\n          for (let i = 0; i < bin.length; i++) {\n            if (bin[i] === '1') {\n              text += ' ' + nodes_ids[i];\n            }\n          }\n          text += ')';\n        });\n\n        div.innerHTML = text;\n\n      });\n\n      return cylinder;\n    }\n\n    const midPoint = new Point((startPoint.x + endPoint.x) / 2, (startPoint.y + endPoint.y) / 2, (startPoint.z + endPoint.z) / 2);\n    return cylinderMesh(startPoint, endPoint, midPoint, currRadius, nextRadius, color); //new THREE.Mesh(geometryCyl, material);\n\n  }\n\n  function getChildsChilds(data, cluster) {\n    var childsChildCount = 0;\n    for (var i = 0; i < cluster[\"Desc\"].length; ++i) {\n      childsChildCount += data[cluster[\"Desc\"][i]][\"NodeCount\"];\n    }\n\n    return childsChildCount;\n  }\n\n  // prevPoint, point - upper and downer middle points of cylinder\n  // dirPoint - point to which direction of cylinder (dir vector) should go \n  function clustering(scene, data, id, max_branching, prevPointFirst, pointFirst, biggestRank) {\n\n    if (id === undefined) {\n      console.log(\"Id is undefined in clustering\");\n      return;\n    }\n\n    function rec(current, prevPoint, point) {\n\n      var cluster = data[current];\n      const childCount = cluster[\"Desc\"].length;\n\n      var childsChildCount = getChildsChilds(data, cluster);\n\n      var cylinder = createCylinder(data, current, prevPoint, point, cluster.NodeCount, childsChildCount, data[current][\"Rank\"], biggestRank);\n\n      const prevPointPointDist = Math.sqrt((point.x - prevPoint.x) * (point.x - prevPoint.x) + (point.y - prevPoint.y)\n                              * (point.y - prevPoint.y) + (point.z - prevPoint.z) * (point.z - prevPoint.z));\n\n      if (childCount === 0) {\n        return [cylinder];\n      }\n\n      var result = [];\n      var newStartPoint = new Point(point.x, point.y, point.z); // to make copy\n      const dirVector = new THREE.Vector3(point.x - prevPoint.x, point.y - prevPoint.y, point.z - prevPoint.z);\n      const newEndPointDir = new Point(dirVector.x + point.x, dirVector.y + point.y, dirVector.z + point.z);\n\n      for (var i = 0; i < childCount; ++i) {\n\n        if (childCount === 1) {\n/*            if (childsChildCount === cluster[\"Desc\"].length && childsChildCount !== 0 && data[cluster[\"Desc\"][0]][\"Desc\"].length !== 0) {\n              cylinder = undefined; // join same-like cluster to one - draw one cluster with bigger height\n              newStartPoint = new Point(prevPoint.x, prevPoint.y, prevPoint.z); // to make copy\n            }\n*/\n          const childrens = rec(cluster[\"Desc\"][0], newStartPoint, newEndPointDir); // array\n          childrens.push(cylinder);\n          return childrens;\n        }\n\n        // COMPUTE NEW COORDINATES around circle\n       // const theta = 2 * Math.PI / childCount;\n        const h = childCount / 2;\n/*\n        var fi = i * theta;\n        if (i <= h && i % 2 === 1) {\n          fi = (Math.ceil(h) - 1 + i) * theta;\n        } else if (i > h && (childCount - 1 - i) % 2 === 0) {\n          fi = (childCount - i) * theta;\n        } if (i > h && (childCount - 1 - i) % 2 === 1) {\n          fi = (Math.ceil(h) - 1 + childCount - i) * theta;\n        }\n\n        var yPos = 0;\n        const half = Math.floor(childCount / 2);\n        if (i !== 0 && i !== half) {\n            if (i < half) {\n              yPos += (1 - cluster[\"Rank\"]/10);\n            } else {\n              yPos -= (1 - cluster[\"Rank\"]/10);\n            }\n        }\n        */\n        \n        const theta = 2 * Math.PI / childCount * i;\n\n\n        var xPos = childsChildCount * Math.cos(theta);\n        var zPos = childsChildCount * Math.sin(theta);\n\n        const vector = new THREE.Vector3(newStartPoint.x - prevPoint.x, newStartPoint.y - prevPoint.y, newStartPoint.z - prevPoint.z).normalize();\n        const distance = Math.sqrt(cluster.NodeCount * cluster.NodeCount + prevPointPointDist * prevPointPointDist);\n        \n        const newStartPointHelper = new Point(\n          prevPoint.x + distance * vector.x,\n          prevPoint.y + distance * vector.y,\n          prevPoint.z + distance * vector.z,\n        );\n        \n\n        const branch_factor = 2 - (1/max_branching) ;\n        xPos = Math.cos(theta) * (childsChildCount ) * branch_factor;\n        zPos = Math.sin(theta) * (childsChildCount ) * branch_factor;\n        const newEndPoint = new Point(newStartPointHelper.x + xPos, newStartPointHelper.y - CYLINDER_HEIGHT, newStartPointHelper.z + zPos);\n      \n        const childrens = rec(cluster[\"Desc\"][i], newStartPoint, newEndPoint);\n        result = result.concat(childrens);\n      }\n\n      const group = new THREE.Group();\n      var positions = {};\n      result.forEach(function (elem) {\n        const position = elem.position;\n        console.log(position);\n\n        positions[elem] = new Point(position.x, position.y, position.z);\n        group.add(elem);\n      });\n\n      const direction = new THREE.Vector3().subVectors( newEndPointDir, newStartPoint );\n\n      const orientation = new THREE.Matrix4();\n      /* THREE.Object3D().up (=Y) default orientation for all objects */\n      orientation.lookAt(newStartPoint, newEndPointDir, new THREE.Object3D().up);\n\n      /* rotation around axis X by -90 degrees \n      * matches the default orientation Y \n      * with the orientation of looking Z */\n      const mat =  new THREE.Matrix4();\n      mat.set(\n        1,0,0,0,\n        0,0,1,0, \n        0,1,0,0,\n        0,0,0,1\n      );\n      \n      orientation.multiply(mat);\n      group.applyMatrix4(orientation);\n      result.forEach(function (elem) {\n        const point = positions[elem];\n        console.log(point);\n        elem.position.set(point.x, point.y, point.z);\n      });\n\n      result.push(cylinder);\n\n      return result;\n    }\n\n    const allObjects = rec(id, prevPointFirst, pointFirst);\n    allObjects.forEach(function (object) {\n      scene.add(object);\n    });\n\n  }\n\n  function compMaxBranching(data, key) {\n\n    let stack = [ key ];\n    var maximums = {}\n    var colors = {}\n\n    while (stack.length > 0) {\n      const current = stack.pop();\n      colors[current] = 'G';\n      stack.push(current);\n      \n      if (maximums[current] === undefined) {\n        maximums[current] = 0\n      }\n\n      var count_black = 0;\n      const desc_count = data[current][\"Desc\"].length;\n      for (var i = 0; i < desc_count; ++i) {\n        if (colors[data[current][\"Desc\"][i]] === undefined) {\n          stack.push(data[current][\"Desc\"][i]);\n        } \n\n        if (colors[data[current][\"Desc\"][i]] === 'B') {\n          count_black += 1;\n          maximums[current] = Math.max(maximums[ data[current][\"Desc\"][i] ], maximums[current]);\n        }\n      }\n\n      if (count_black === desc_count) {\n        colors[current] = 'B';\n        stack.pop();\n\n        if (desc_count > 1) {\n          maximums[current] += 1;\n        }\n      }\n    }\n\n    return maximums[key];\n  }\n\n  function processClusters(scene, data) {\n\n    var root_cluster_key = undefined;\n    var biggestRank = 0;\n    Object.entries(data).forEach(([k,v]) => {\n      if (v[\"Rank\"] === 0) {\n        root_cluster_key = k;\n      }\n      biggestRank = Math.max(v[\"Rank\"], biggestRank);\n    });\n\n    const max_branching = compMaxBranching(data, root_cluster_key);\n\n    const firstHeight = biggestRank * CYLINDER_HEIGHT / 2 + CYLINDER_HEIGHT;\n    const firstStartPoint = new Point(0, firstHeight, 0);\n    const firstEndPoint = new Point(0, firstHeight - CYLINDER_HEIGHT, 0);\n\n    clustering(scene, data, root_cluster_key, max_branching, firstStartPoint, firstEndPoint, biggestRank);\n  }\n}\n\n\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}