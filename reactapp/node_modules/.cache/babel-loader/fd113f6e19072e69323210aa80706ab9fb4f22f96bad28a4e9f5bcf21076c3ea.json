{"ast":null,"code":"import _slicedToArray from\"/home/xkruzel/Desktop/todo/reactapp/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import*as THREE from\"three\";import{OrbitControls}from\"three/examples/jsm/controls/OrbitControls\";import*as dat from\"dat.gui\";import{Point,createPoint}from\"./Point\";import{Interaction}from\"three.interaction-fixed\";import{dec2bin,rad2degrees}from\"./utils\";export function init3Dgraphics(canvas,div,data,nodes_ids,h,w){if(data===undefined){return false;}var CYLINDER_HEIGHT=8;var number_of_nodes=Object.keys(nodes_ids).length;var scene=new THREE.Scene();//scene.background = new THREE.Color( 0xd3d3d3 );\nscene.background=new THREE.Color(0xf8f2ea);var camera=new THREE.PerspectiveCamera(75,canvas.width/canvas.height,0.1,1000);var renderer=new THREE.WebGLRenderer({canvas:canvas});renderer.setPixelRatio(window.devicePixelRatio);renderer.setSize(canvas.width,canvas.height);// full size\ncamera.position.setZ(30);// for better perspective\nrenderer.sortObjects=false;renderer.render(scene,camera);new Interaction(renderer,scene,camera);// For showing text information about clusters\nvar texts=[];var cylinders=[];//const axesHelper = new THREE.AxesHelper(100);\n//scene.add(axesHelper);\n/*\n  const gui = new dat.GUI();\n  const options = {\n    sphereColor : 0xffea00,\n    wireframe: false,\n  };\n*/var pointLight=new THREE.PointLight(0xffffff);pointLight.position.set(20,20,20);var ambientLight=new THREE.AmbientLight(0xffffff);ambientLight.position.set(20,20,20);scene.add(pointLight,ambientLight);//const lightHelper = new THREE.PointLightHelper(pointLight);  // shows position of lighsource\n//const gridHelper = new THREE.GridHelper(30, 20);\n//scene.add(lightHelper, gridHelper);\nwindow.addEventListener(\"resize\",function(){camera.aspect=canvas.width/canvas.height;camera.updateProjectionMatrix();renderer.setSize(canvas.width);});var controls=new OrbitControls(camera,renderer.domElement);help();// processClusters(scene, data);\ndata=null;function animate(){setTimeout(function(){requestAnimationFrame(animate);},1000/5);controls.update();renderer.render(scene,camera);pointLight.position.copy(camera.position);}renderer.setAnimationLoop(animate);window.addEventListener(\"resize\",function(){camera.aspect=canvas.width/canvas.width;camera.updateProjectionMatrix();renderer.setSize(canvas.width,canvas.width);});function calcColor(max,val){return\"hsla(147, 0%, 50%, 1)\";/*\n    const min = 0\n    var minHue = 240, maxHue=0;\n    var curPercent = (val - min) / (max-min);\n    var colString = \"hsl(\" + ((curPercent * (maxHue-minHue) ) + minHue) + \",65%,50%)\";\n    return colString;\n    */}function help(){function createCylinder(endPoint,startPoint,u,l){var direction=new THREE.Vector3().subVectors(endPoint,startPoint);var midPoint=new Point((startPoint.x+endPoint.x)/2,(startPoint.y+endPoint.y)/2,(startPoint.z+endPoint.z)/2);var orientation=new THREE.Matrix4();/* THREE.Object3D().up (=Y) default orientation for all objects */orientation.lookAt(startPoint,endPoint,new THREE.Object3D().up);/* rotation around axis X by -90 degrees\n       * matches the default orientation Y\n       * with the orientation of looking Z */var mat=new THREE.Matrix4();mat.set(1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1);orientation.multiply(mat);/* cylinder: radiusAtTop, radiusAtBottom, \n          height, radiusSegments, heightSegments */var RADIAL_SEGMENTS=8;var HEIGHT_SEGMENTS=1;var edgeGeometry=new THREE.CylinderGeometry(u,l,CYLINDER_HEIGHT,Math.max(100,l*RADIAL_SEGMENTS),HEIGHT_SEGMENTS);var newMaterial=new THREE.MeshPhongMaterial({color:\"hsla(186, 50%, 70%, 1)\",flatShading:true});newMaterial.opacity=0.5;var cylinder=new THREE.Mesh(edgeGeometry,newMaterial);cylinder.applyMatrix4(orientation);cylinder.position.set(midPoint.x,midPoint.y,midPoint.z);scene.add(cylinder);}createCylinder(new Point(0,0,0),new Point(4,-10,0),3,5);createCylinder(new Point(4,-10,0),new Point(8,-20,0),5,2);}function resetOpacity(){cylinders.forEach(function(cylinder){var newMaterial=cylinder.material.clone();newMaterial.transparent=false;newMaterial.opacity=1;cylinder.material=newMaterial;});}function crossProduct(a,b){return new THREE.Vector3(a.y*b.z-a.z*b.y,a.z*b.x-a.x*b.z,a.x*b.y-a.y*b.x);}function createCylinder(data,id,startPoint,endPoint,currRadius,nextRadius,rank,rank_max){console.log(id);var color=new THREE.Color(data[id][\"Color\"]===\"\"?calcColor(rank_max,rank):data[id][\"Color\"]);//color.setHex(rank/10 * 0xffffff );\n// color.setHex(rank/10 * 0xffffff );\nvar cylinderMesh=function cylinderMesh(startPoint,endPoint,midPoint,currRadius,nextRadius,color){/* edge from X to Y */var direction=new THREE.Vector3().subVectors(endPoint,startPoint);var orientation=new THREE.Matrix4();/* THREE.Object3D().up (=Y) default orientation for all objects */orientation.lookAt(startPoint,endPoint,new THREE.Object3D().up);/* rotation around axis X by -90 degrees\n       * matches the default orientation Y\n       * with the orientation of looking Z */var mat=new THREE.Matrix4();mat.set(1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1);orientation.multiply(mat);/* cylinder: radiusAtTop, radiusAtBottom, \n          height, radiusSegments, heightSegments */var RADIAL_SEGMENTS=8;var HEIGHT_SEGMENTS=1;var edgeGeometry=new THREE.CylinderGeometry(currRadius,nextRadius,CYLINDER_HEIGHT,Math.max(100,nextRadius*RADIAL_SEGMENTS),HEIGHT_SEGMENTS);var cylinder=new THREE.Mesh(edgeGeometry,new THREE.MeshPhongMaterial({color:color,flatShading:true}));cylinder.applyMatrix4(orientation);cylinder.position.set(midPoint.x,midPoint.y,midPoint.z);cylinder.cursor=\"pointer\";cylinder.on(\"click\",function(ev){resetOpacity();var newMaterial=cylinder.material.clone();newMaterial.transparent=true;newMaterial.opacity=0.5;cylinder.material=newMaterial;texts.forEach(function(text){var selectedObject=scene.getObjectByName(text.name);scene.remove(selectedObject);});var text=\"\";data[id][\"Nodes\"].forEach(function(elem){if(text!==\"\"){text+=\",\";}text+=\" (\";var bin=dec2bin(elem,number_of_nodes);for(var i=0;i<bin.length;i++){if(bin[i]===\"1\"){text+=\" \"+nodes_ids[i];}}text+=\" )\";});div.innerHTML=\"<b>Rank</b>: \"+data[id][\"Rank\"]+\"<br><b>Nodes</b>: \"+text;});return cylinder;};var midPoint=new Point((startPoint.x+endPoint.x)/2,(startPoint.y+endPoint.y)/2,(startPoint.z+endPoint.z)/2);return cylinderMesh(startPoint,endPoint,midPoint,currRadius,nextRadius,color);//new THREE.Mesh(geometryCyl, material);\n}function getChildsChilds(data,cluster){var childsChildCount=0;for(var i=0;i<cluster[\"Desc\"].length;++i){childsChildCount+=data[cluster[\"Desc\"][i]].NodeCount;}return childsChildCount;}// prevPoint, point - upper and downer middle points of cylinder\n// dirPoint - point to which direction of cylinder (dir vector) should go\nfunction clustering(scene,data,id,max_branching,prevPointFirst,pointFirst,biggestRank){if(id===undefined){console.log(\"Id is undefined in clustering\");return;}var firstId=id;var tuple=Object.freeze({id:id,prevPoint:prevPointFirst,point:pointFirst});var stack=[tuple];var yaxis=new Point(0,1,0);while(stack.length>0){var stackElement=stack.pop();var current=stackElement.id;var prevPoint=stackElement.prevPoint;var point=stackElement.point;var cluster=data[current];var childCount=cluster[\"Desc\"].length;var childsChildCount=getChildsChilds(data,cluster);var upperRadius=cluster.NodeCount;var lowerRadius=childCount===1?childsChildCount:childsChildCount+cluster[\"Desc\"].length;var cylinder=createCylinder(data,current,prevPoint,point,upperRadius,lowerRadius,data[current][\"Rank\"],biggestRank);var xVector=new THREE.Vector3(1,0,0);var yVector=new THREE.Vector3(0,1,0);var zVector=new THREE.Vector3(0,0,1);var dirVector=new THREE.Vector3(point.x-prevPoint.x,point.y-prevPoint.y,point.z-prevPoint.z);for(var i=0;i<childCount;++i){if(childCount===1){dirVector=new THREE.Vector3(point.x-prevPoint.x,point.y-prevPoint.y,point.z-prevPoint.z);var newStartPoint=new Point(point.x,point.y,point.z);// to make copy\nvar newPoint=new Point(dirVector.x+point.x,dirVector.y+point.y,dirVector.z+point.z);tuple=Object.freeze({id:cluster[\"Desc\"][0],prevPoint:newStartPoint,point:newPoint});stack.push(tuple);continue;}var uVector=new THREE.Vector3(-1*dirVector.y,dirVector.x,0).normalize();var adota=uVector.dot(uVector);var crossProductVec=crossProduct(dirVector,uVector);var vVector=crossProductVec.divideScalar(adota).normalize();dirVector.normalize();// COMPUTE NEW COORDINATES around circle - not rotated circle\nvar theta=2*Math.PI/childCount*i;var sin=Math.sin(theta);var cos=Math.cos(theta);var u=uVector.multiplyScalar(Math.cos(2*Math.PI/childCount*i)*lowerRadius);var v=vVector.multiplyScalar(Math.sin(2*Math.PI/childCount*i)*lowerRadius);var newStartPointHelper=u.add(v).add(new THREE.Vector3(point.x,point.y,point.z));var vector=new THREE.Vector3(newStartPointHelper.x-prevPoint.x,newStartPointHelper.y-prevPoint.y,newStartPointHelper.z-prevPoint.z).normalize();var distance=Math.floor(Math.sqrt(Math.pow(lowerRadius,2)+Math.pow(CYLINDER_HEIGHT,2)));var newEndPoint=new Point(newStartPointHelper.x+CYLINDER_HEIGHT*vector.x,newStartPointHelper.y+CYLINDER_HEIGHT*vector.y,newStartPointHelper.z+CYLINDER_HEIGHT*vector.z);tuple=Object.freeze({id:cluster[\"Desc\"][i],prevPoint:newStartPointHelper,point:newEndPoint});stack.push(tuple);}if(cylinder!==undefined){cylinders.push(cylinder);// if (current === firstId) {\nscene.add(cylinder);// }\n}}}function compMaxBranching(data,key){var stack=[key];var maximums={};var colors={};while(stack.length>0){var current=stack.pop();colors[current]=\"G\";stack.push(current);if(maximums[current]===undefined){maximums[current]=0;}var count_black=0;var desc_count=data[current][\"Desc\"].length;for(var i=0;i<desc_count;++i){if(colors[data[current][\"Desc\"][i]]===undefined){stack.push(data[current][\"Desc\"][i]);}if(colors[data[current][\"Desc\"][i]]===\"B\"){count_black+=1;maximums[current]=Math.max(maximums[data[current][\"Desc\"][i]],maximums[current]);}}if(count_black===desc_count){colors[current]=\"B\";stack.pop();if(desc_count>1){maximums[current]+=1;}}}return maximums[key];}function processClusters(scene,data){var root_cluster_key=undefined;var biggestRank=0;Object.entries(data).forEach(function(_ref){var _ref2=_slicedToArray(_ref,2),k=_ref2[0],v=_ref2[1];if(v[\"Rank\"]===0){root_cluster_key=k;}biggestRank=Math.max(v[\"Rank\"],biggestRank);});var max_branching=compMaxBranching(data,root_cluster_key);var firstHeight=biggestRank*CYLINDER_HEIGHT/2+CYLINDER_HEIGHT;var firstStartPoint=new Point(0,firstHeight,0);var firstEndPoint=new Point(0,firstHeight-CYLINDER_HEIGHT,0);clustering(scene,data,root_cluster_key,max_branching,firstStartPoint,firstEndPoint,biggestRank);}}","map":{"version":3,"names":["THREE","OrbitControls","dat","Point","createPoint","Interaction","dec2bin","rad2degrees","init3Dgraphics","canvas","div","data","nodes_ids","h","w","undefined","CYLINDER_HEIGHT","number_of_nodes","Object","keys","length","scene","Scene","background","Color","camera","PerspectiveCamera","width","height","renderer","WebGLRenderer","setPixelRatio","window","devicePixelRatio","setSize","position","setZ","sortObjects","render","texts","cylinders","pointLight","PointLight","set","ambientLight","AmbientLight","add","addEventListener","aspect","updateProjectionMatrix","controls","domElement","help","animate","setTimeout","requestAnimationFrame","update","copy","setAnimationLoop","calcColor","max","val","createCylinder","endPoint","startPoint","u","l","direction","Vector3","subVectors","midPoint","x","y","z","orientation","Matrix4","lookAt","Object3D","up","mat","multiply","RADIAL_SEGMENTS","HEIGHT_SEGMENTS","edgeGeometry","CylinderGeometry","Math","newMaterial","MeshPhongMaterial","color","flatShading","opacity","cylinder","Mesh","applyMatrix4","resetOpacity","forEach","material","clone","transparent","crossProduct","a","b","id","currRadius","nextRadius","rank","rank_max","console","log","cylinderMesh","cursor","on","ev","text","selectedObject","getObjectByName","name","remove","elem","bin","i","innerHTML","getChildsChilds","cluster","childsChildCount","NodeCount","clustering","max_branching","prevPointFirst","pointFirst","biggestRank","firstId","tuple","freeze","prevPoint","point","stack","yaxis","stackElement","pop","current","childCount","upperRadius","lowerRadius","xVector","yVector","zVector","dirVector","newStartPoint","newPoint","push","uVector","normalize","adota","dot","crossProductVec","vVector","divideScalar","theta","PI","sin","cos","multiplyScalar","v","newStartPointHelper","vector","distance","floor","sqrt","pow","newEndPoint","compMaxBranching","key","maximums","colors","count_black","desc_count","processClusters","root_cluster_key","entries","k","firstHeight","firstStartPoint","firstEndPoint"],"sources":["/home/xkruzel/Desktop/todo/reactapp/src/rendering.js"],"sourcesContent":["import * as THREE from \"three\";\nimport { OrbitControls } from \"three/examples/jsm/controls/OrbitControls\";\nimport * as dat from \"dat.gui\";\nimport { Point, createPoint } from \"./Point\";\nimport { Interaction } from \"three.interaction-fixed\";\nimport { dec2bin, rad2degrees } from \"./utils\";\n\n\n\nexport function init3Dgraphics(canvas, div, data, nodes_ids, h, w) {\n  if (data === undefined) {\n    return false;\n  }\n\n  const CYLINDER_HEIGHT = 8;\n  const number_of_nodes = Object.keys(nodes_ids).length;\n\n  const scene = new THREE.Scene();\n  //scene.background = new THREE.Color( 0xd3d3d3 );\n  scene.background = new THREE.Color(0xf8f2ea);\n  const camera = new THREE.PerspectiveCamera(\n    75,\n    canvas.width / canvas.height,\n    0.1,\n    1000\n  );\n  const renderer = new THREE.WebGLRenderer({\n    canvas: canvas,\n  });\n\n  renderer.setPixelRatio(window.devicePixelRatio);\n  renderer.setSize(canvas.width, canvas.height); // full size\n  camera.position.setZ(30); // for better perspective\n  renderer.sortObjects = false;\n  renderer.render(scene, camera);\n\n  new Interaction(renderer, scene, camera);\n\n  // For showing text information about clusters\n  var texts = [];\n  var cylinders = [];\n\n  //const axesHelper = new THREE.AxesHelper(100);\n  //scene.add(axesHelper);\n\n  /*\n  const gui = new dat.GUI();\n  const options = {\n    sphereColor : 0xffea00,\n    wireframe: false,\n  };\n*/\n  const pointLight = new THREE.PointLight(0xffffff);\n  pointLight.position.set(20, 20, 20);\n\n  const ambientLight = new THREE.AmbientLight(0xffffff);\n  ambientLight.position.set(20, 20, 20);\n\n  scene.add(pointLight, ambientLight);\n\n  //const lightHelper = new THREE.PointLightHelper(pointLight);  // shows position of lighsource\n  //const gridHelper = new THREE.GridHelper(30, 20);\n\n  //scene.add(lightHelper, gridHelper);\n\n  window.addEventListener(\"resize\", function () {\n    camera.aspect = canvas.width / canvas.height;\n    camera.updateProjectionMatrix();\n    renderer.setSize(canvas.width);\n  });\n\n  const controls = new OrbitControls(camera, renderer.domElement);\n\n  help();\n\n // processClusters(scene, data);\n  data = null;\n\n  function animate() {\n    setTimeout(function () {\n      requestAnimationFrame(animate);\n    }, 1000 / 5);\n\n    controls.update();\n    renderer.render(scene, camera);\n    pointLight.position.copy(camera.position);\n  }\n\n  renderer.setAnimationLoop(animate);\n\n  window.addEventListener(\"resize\", function () {\n    camera.aspect = canvas.width / canvas.width;\n    camera.updateProjectionMatrix();\n    renderer.setSize(canvas.width, canvas.width);\n  });\n\n  function calcColor(max, val) {\n    return \"hsla(147, 0%, 50%, 1)\";\n    /*\n    const min = 0\n    var minHue = 240, maxHue=0;\n    var curPercent = (val - min) / (max-min);\n    var colString = \"hsl(\" + ((curPercent * (maxHue-minHue) ) + minHue) + \",65%,50%)\";\n    return colString;\n    */\n  }\n\n\n\n  function help() {\n\n    function createCylinder(endPoint, startPoint, u, l) {\n     const direction = new THREE.Vector3().subVectors(endPoint, startPoint);\n         const midPoint = new Point(\n      (startPoint.x + endPoint.x) / 2,\n      (startPoint.y + endPoint.y) / 2,\n      (startPoint.z + endPoint.z) / 2\n    );\n\n      const orientation = new THREE.Matrix4();\n      /* THREE.Object3D().up (=Y) default orientation for all objects */\n      orientation.lookAt(startPoint, endPoint, new THREE.Object3D().up);\n\n      /* rotation around axis X by -90 degrees\n       * matches the default orientation Y\n       * with the orientation of looking Z */\n      const mat = new THREE.Matrix4();\n      mat.set(1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1);\n      orientation.multiply(mat);\n\n      /* cylinder: radiusAtTop, radiusAtBottom, \n          height, radiusSegments, heightSegments */\n      const RADIAL_SEGMENTS = 8;\n      const HEIGHT_SEGMENTS = 1;\n      const edgeGeometry = new THREE.CylinderGeometry(\n        u,\n        l,\n        CYLINDER_HEIGHT,\n        Math.max(100, l * RADIAL_SEGMENTS),\n        HEIGHT_SEGMENTS\n      );\n\n\n      var newMaterial = new THREE.MeshPhongMaterial({ color: \"hsla(186, 50%, 70%, 1)\", flatShading: true });\n      newMaterial.opacity = 0.5;\n\n      const cylinder = new THREE.Mesh(\n        edgeGeometry,\n        newMaterial\n      );\n\n      cylinder.applyMatrix4(orientation);\n      cylinder.position.set(midPoint.x, midPoint.y, midPoint.z);\n      scene.add(cylinder);\n    }\n\n    createCylinder(new Point(0, 0, 0), new Point(4, -10, 0), 3, 5);\n    createCylinder(new Point(4, -10, 0), new Point(8, -20, 0), 5, 2);\n\n\n  }\n\n  function resetOpacity() {\n    cylinders.forEach(function (cylinder) {\n      const newMaterial = cylinder.material.clone();\n      newMaterial.transparent = false;\n      newMaterial.opacity = 1;\n      cylinder.material = newMaterial;\n    });\n  }\n\n  function crossProduct(a, b) {\n    return new THREE.Vector3(\n      a.y * b.z - a.z * b.y,\n      a.z * b.x - a.x * b.z,\n      a.x * b.y - a.y * b.x\n    );\n  }\n\n  function createCylinder(\n    data,\n    id,\n    startPoint,\n    endPoint,\n    currRadius,\n    nextRadius,\n    rank,\n    rank_max\n  ) {\n    console.log(id);\n    const color = new THREE.Color(\n      data[id][\"Color\"] === \"\" ? calcColor(rank_max, rank) : data[id][\"Color\"]\n    );\n    //color.setHex(rank/10 * 0xffffff );\n    // color.setHex(rank/10 * 0xffffff );\n\n    var cylinderMesh = function (\n      startPoint,\n      endPoint,\n      midPoint,\n      currRadius,\n      nextRadius,\n      color\n    ) {\n      /* edge from X to Y */\n      const direction = new THREE.Vector3().subVectors(endPoint, startPoint);\n\n      const orientation = new THREE.Matrix4();\n      /* THREE.Object3D().up (=Y) default orientation for all objects */\n      orientation.lookAt(startPoint, endPoint, new THREE.Object3D().up);\n\n      /* rotation around axis X by -90 degrees\n       * matches the default orientation Y\n       * with the orientation of looking Z */\n      const mat = new THREE.Matrix4();\n      mat.set(1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1);\n      orientation.multiply(mat);\n\n      /* cylinder: radiusAtTop, radiusAtBottom, \n          height, radiusSegments, heightSegments */\n      const RADIAL_SEGMENTS = 8;\n      const HEIGHT_SEGMENTS = 1;\n      const edgeGeometry = new THREE.CylinderGeometry(\n        currRadius,\n        nextRadius,\n        CYLINDER_HEIGHT,\n        Math.max(100, nextRadius * RADIAL_SEGMENTS),\n        HEIGHT_SEGMENTS\n      );\n      const cylinder = new THREE.Mesh(\n        edgeGeometry,\n        new THREE.MeshPhongMaterial({ color: color, flatShading: true })\n      );\n\n      cylinder.applyMatrix4(orientation);\n      cylinder.position.set(midPoint.x, midPoint.y, midPoint.z);\n      cylinder.cursor = \"pointer\";\n      cylinder.on(\"click\", function (ev) {\n        resetOpacity();\n        const newMaterial = cylinder.material.clone();\n        newMaterial.transparent = true;\n        newMaterial.opacity = 0.5;\n        cylinder.material = newMaterial;\n\n        texts.forEach(function (text) {\n          var selectedObject = scene.getObjectByName(text.name);\n          scene.remove(selectedObject);\n        });\n\n        var text = \"\";\n        data[id][\"Nodes\"].forEach(function (elem) {\n          if (text !== \"\") {\n            text += \",\";\n          }\n          text += \" (\";\n          const bin = dec2bin(elem, number_of_nodes);\n\n          for (let i = 0; i < bin.length; i++) {\n            if (bin[i] === \"1\") {\n              text += \" \" + nodes_ids[i];\n            }\n          }\n          text += \" )\";\n        });\n\n        div.innerHTML =\n          \"<b>Rank</b>: \" + data[id][\"Rank\"] + \"<br><b>Nodes</b>: \" + text;\n      });\n\n      return cylinder;\n    };\n\n    const midPoint = new Point(\n      (startPoint.x + endPoint.x) / 2,\n      (startPoint.y + endPoint.y) / 2,\n      (startPoint.z + endPoint.z) / 2\n    );\n    return cylinderMesh(\n      startPoint,\n      endPoint,\n      midPoint,\n      currRadius,\n      nextRadius,\n      color\n    ); //new THREE.Mesh(geometryCyl, material);\n  }\n\n  function getChildsChilds(data, cluster) {\n    var childsChildCount = 0;\n    for (var i = 0; i < cluster[\"Desc\"].length; ++i) {\n      childsChildCount += data[cluster[\"Desc\"][i]].NodeCount;\n    }\n\n    return childsChildCount;\n  }\n\n  // prevPoint, point - upper and downer middle points of cylinder\n  // dirPoint - point to which direction of cylinder (dir vector) should go\n  function clustering(\n    scene,\n    data,\n    id,\n    max_branching,\n    prevPointFirst,\n    pointFirst,\n    biggestRank\n  ) {\n    if (id === undefined) {\n      console.log(\"Id is undefined in clustering\");\n      return;\n    }\n    const firstId = id;\n\n    var tuple = Object.freeze({\n      id: id,\n      prevPoint: prevPointFirst,\n      point: pointFirst,\n    });\n    var stack = [tuple];\n\n    const yaxis = new Point(0, 1, 0);\n\n    while (stack.length > 0) {\n      const stackElement = stack.pop();\n      const current = stackElement.id;\n      const prevPoint = stackElement.prevPoint;\n      const point = stackElement.point;\n\n      var cluster = data[current];\n      const childCount = cluster[\"Desc\"].length;\n\n      var childsChildCount = getChildsChilds(data, cluster);\n\n      const upperRadius = cluster.NodeCount;\n      const lowerRadius =\n        childCount === 1\n          ? childsChildCount\n          : childsChildCount + cluster[\"Desc\"].length;\n\n      var cylinder = createCylinder(\n        data,\n        current,\n        prevPoint,\n        point,\n        upperRadius,\n        lowerRadius,\n        data[current][\"Rank\"],\n        biggestRank\n      );\n\n      const xVector = new THREE.Vector3(1, 0, 0);\n      const yVector = new THREE.Vector3(0, 1, 0);\n      const zVector = new THREE.Vector3(0, 0, 1);\n\n      var dirVector = new THREE.Vector3(\n        point.x - prevPoint.x,\n        point.y - prevPoint.y,\n        point.z - prevPoint.z\n      );\n\n\n      for (var i = 0; i < childCount; ++i) {\n        if (childCount === 1) {\n          dirVector = new THREE.Vector3(\n            point.x - prevPoint.x,\n            point.y - prevPoint.y,\n            point.z - prevPoint.z\n          );\n\n          var newStartPoint = new Point(point.x, point.y, point.z); // to make copy\n          const newPoint = new Point(\n            dirVector.x + point.x,\n            dirVector.y + point.y,\n            dirVector.z + point.z\n          );\n\n          tuple = Object.freeze({\n            id: cluster[\"Desc\"][0],\n            prevPoint: newStartPoint,\n            point: newPoint,\n          });\n          stack.push(tuple);\n\n          continue;\n        }\n\n        const uVector = new THREE.Vector3((-1) * dirVector.y, dirVector.x, 0).normalize();\n\n        const adota = uVector.dot(uVector);\n        const crossProductVec = crossProduct(dirVector, uVector);\n        const vVector = crossProductVec.divideScalar(adota).normalize();\n        dirVector.normalize();\n\n\n        // COMPUTE NEW COORDINATES around circle - not rotated circle\n        const theta = (2*Math.PI / childCount) * i;\n        const sin = Math.sin(theta);\n        const cos = Math.cos(theta);\n\n\n        const u = uVector.multiplyScalar(Math.cos((2*Math.PI / childCount) * i) * lowerRadius);\n\n        const v = vVector.multiplyScalar(Math.sin((2*Math.PI / childCount) * i) * lowerRadius);\n\n        var newStartPointHelper = u\n          .add(v)\n          .add(new THREE.Vector3(point.x, point.y, point.z));\n\n\n        const vector = new THREE.Vector3(\n          newStartPointHelper.x - prevPoint.x,\n          newStartPointHelper.y - prevPoint.y,\n          newStartPointHelper.z - prevPoint.z\n        ).normalize();\n\n        const distance = Math.floor(\n          Math.sqrt(Math.pow(lowerRadius, 2) + Math.pow(CYLINDER_HEIGHT, 2))\n        );\n\n        const newEndPoint = new Point(\n          newStartPointHelper.x + CYLINDER_HEIGHT * vector.x,\n          newStartPointHelper.y + CYLINDER_HEIGHT * vector.y,\n          newStartPointHelper.z + CYLINDER_HEIGHT * vector.z\n        );\n\n        tuple = Object.freeze({\n          id: cluster[\"Desc\"][i],\n          prevPoint: newStartPointHelper,\n          point: newEndPoint,\n        });\n        stack.push(tuple);\n      }\n\n      if (cylinder !== undefined) {\n        cylinders.push(cylinder);\n        // if (current === firstId) {\n        scene.add(cylinder);\n        // }\n      }\n    }\n  }\n\n  function compMaxBranching(data, key) {\n    let stack = [key];\n    var maximums = {};\n    var colors = {};\n\n    while (stack.length > 0) {\n      const current = stack.pop();\n      colors[current] = \"G\";\n      stack.push(current);\n\n      if (maximums[current] === undefined) {\n        maximums[current] = 0;\n      }\n\n      var count_black = 0;\n      const desc_count = data[current][\"Desc\"].length;\n      for (var i = 0; i < desc_count; ++i) {\n        if (colors[data[current][\"Desc\"][i]] === undefined) {\n          stack.push(data[current][\"Desc\"][i]);\n        }\n\n        if (colors[data[current][\"Desc\"][i]] === \"B\") {\n          count_black += 1;\n          maximums[current] = Math.max(\n            maximums[data[current][\"Desc\"][i]],\n            maximums[current]\n          );\n        }\n      }\n\n      if (count_black === desc_count) {\n        colors[current] = \"B\";\n        stack.pop();\n\n        if (desc_count > 1) {\n          maximums[current] += 1;\n        }\n      }\n    }\n\n    return maximums[key];\n  }\n\n  function processClusters(scene, data) {\n    var root_cluster_key = undefined;\n    var biggestRank = 0;\n    Object.entries(data).forEach(([k, v]) => {\n      if (v[\"Rank\"] === 0) {\n        root_cluster_key = k;\n      }\n      biggestRank = Math.max(v[\"Rank\"], biggestRank);\n    });\n\n    const max_branching = compMaxBranching(data, root_cluster_key);\n\n    const firstHeight = (biggestRank * CYLINDER_HEIGHT) / 2 + CYLINDER_HEIGHT;\n    const firstStartPoint = new Point(0, firstHeight, 0);\n    const firstEndPoint = new Point(0, firstHeight - CYLINDER_HEIGHT, 0);\n\n    clustering(\n      scene,\n      data,\n      root_cluster_key,\n      max_branching,\n      firstStartPoint,\n      firstEndPoint,\n      biggestRank\n    );\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}