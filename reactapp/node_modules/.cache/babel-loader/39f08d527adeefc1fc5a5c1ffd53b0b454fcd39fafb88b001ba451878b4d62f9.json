{"ast":null,"code":"import{dec2bin}from'./utils.js';import*as THREE from\"three\";import{Point}from\"./Point\";import{GLTFExporter}from\"three/examples/jsm/exporters/GLTFExporter.js\";export var NEUTRAL_COLOR=\"hsl(255, 0%, 46%)\";export var CYLINDER_HEIGHT=8;var RADIAL_SEGMENTS=8;var HEIGHT_SEGMENTS=1;function resetOpacity(cylinders){cylinders.forEach(function(cylinder){var newMaterial=cylinder.material.clone();newMaterial.transparent=false;newMaterial.opacity=1;cylinder.material=newMaterial;});}export function resetText(texts,scene){texts.forEach(function(text){var selectedObject=scene.getObjectByName(text.name);scene.remove(selectedObject);});}export function getChildsChilds(data,cluster){var childsChildCount=0;for(var i=0;i<cluster[\"Desc\"].length;++i){childsChildCount+=data[cluster[\"Desc\"][i]].NodeCount;}if(cluster[\"Separate\"]!==undefined){childsChildCount=data[cluster[\"Separate\"]].NodeCount;}return childsChildCount;}export function createCoordinatesForSingleSon(point,prevPoint,id){var dirVector=new THREE.Vector3(point.x-prevPoint.x,point.y-prevPoint.y,point.z-prevPoint.z);var newStartPoint=new Point(point.x,point.y,point.z);// to make copy\nvar newPoint=new Point(dirVector.x+point.x,dirVector.y+point.y,dirVector.z+point.z);return Object.freeze({id:id,//cluster[\"Desc\"][0],\nprevPoint:newStartPoint,point:newPoint});}export function createDescriptionForCluster(cluster,cylinder,nodes_ids,number_of_nodes){var text=\"\";cluster[\"Nodes\"].forEach(function(elem){if(text!==\"\"){text+=\",\";}text+=\" (\";var bin=dec2bin(elem,number_of_nodes);for(var i=0;i<bin.length;i++){if(bin[i]===\"1\"){text+=\" \"+nodes_ids[i];}}text+=\" )\";});var atraktor=cylinder.userData.isAtractor?\"<br><b>Atraktor</b>\":\"\";return\"<b>Rank</b>: \"+cluster[\"Rank\"]+\"<br><b>Nodes</b>: \"+text+atraktor;}export function calcColorBacks(cluster){if(cluster[\"Backs\"].length>0){return\"hsl(259, 20%, 30%)\";}return NEUTRAL_COLOR;}function calcColorRank(max,val){var min=0;var minHue=240,maxHue=0;var curPercent=(val-min)/(max-min);var colString=\"hsl(\"+(curPercent*(maxHue-minHue)+minHue)+\",25%,40%)\";return colString;}export function crossProduct(a,b){return new THREE.Vector3(a.y*b.z-a.z*b.y,a.z*b.x-a.x*b.z,a.x*b.y-a.y*b.x);}export function save(blob,filename){var link=document.createElement('a');link.style.display='none';document.body.appendChild(link);link.href=URL.createObjectURL(blob);link.download=filename;link.click();// URL.revokeObjectURL( url ); breaks Firefox...\n}export function saveString(text,filename){save(new Blob([text],{type:'text/plain'}),filename);}export function saveArrayBuffer(buffer,filename){save(new Blob([buffer],{type:'application/octet-stream'}),filename);}export function exportGLTE(input){var gltfExporter=new GLTFExporter();gltfExporter.parse(input,function(result){if(result instanceof ArrayBuffer){saveArrayBuffer(result,'object.glb');}else{var output=JSON.stringify(result,null,2);saveString(output,'object.gltf');}},function(error){console.log('An error happened during parsing',error);});};export function createControls(gui,cylinders,group){/* Colors */var parameters_colors=[{check:true},// color for back edges \n{check:false},// color for ranks\n{check:false}// color for None colors\n];var folder=gui.addFolder(\"Colors\");folder.add(parameters_colors[0],'check').name('Back edges').listen().onChange(function(e){setChecked(0);if(e){cylinders.forEach(function(cylinder){if(!cylinder.userData.isAtractor){cylinder.material.color=cylinder.userData.colorBacks;}});}});folder.add(parameters_colors[1],'check').name('Ranks').listen().onChange(function(e){setChecked(1);if(e){cylinders.forEach(function(cylinder){if(!cylinder.userData.isAtractor){cylinder.material.color=cylinder.userData.colorRank;}});}});folder.add(parameters_colors[2],'check').name('None').listen().onChange(function(e){setChecked(2);if(e){cylinders.forEach(function(cylinder){if(!cylinder.userData.isAtractor){cylinder.material.color=new THREE.Color(NEUTRAL_COLOR);}});}});function setChecked(prop){for(var param in parameters_colors){parameters_colors[param].check=false;}parameters_colors[prop].check=true;}/* Export */var params_export={export:exportGLTEObject};var folder_export=gui.addFolder(\"Export\");folder_export.add(params_export,'export').name('Export in gltf format');/* Move */var params_move={right:moveObjectToRight,left:moveObjectToLeft,up:moveObjectUp,down:moveObjectDown,close:modeObjectCloser,far:moveObjectFar};var folder_move=gui.addFolder(\"Move\");folder_move.add(params_move,'right').name('Move to right');folder_move.add(params_move,'left').name('Move to left');folder_move.add(params_move,'up').name('Move up');folder_move.add(params_move,'down').name('Move down');folder_move.add(params_move,'close').name('Move closer');folder_move.add(params_move,'far').name('Move away');function moveObjectToRight(){group.position.set(group.position.x+5,group.position.y,group.position.z);}function moveObjectToLeft(){group.position.set(group.position.x-5,group.position.y,group.position.z);}function moveObjectUp(){group.position.set(group.position.x,group.position.y+5,group.position.z);}function moveObjectDown(){group.position.set(group.position.x,group.position.y-5,group.position.z);}function modeObjectCloser(){group.position.set(group.position.x,group.position.y,group.position.z+5);}function moveObjectFar(){group.position.set(group.position.x,group.position.y,group.position.z-5);}function exportGLTEObject(){return exportGLTE(group);}}function cylinderMesh(data,startPoint,// point A, for vector (A, B) giving cylinder its direction of rotation\nendPoint,// point B, for vector (A, B) described at startPoint\nmidPoint,// position of mesh\nupperRadius,lowerRadius,colorBacks,// color for back variation of coloring\ncolorRank,// color for rank variation of coloring - with colorBacks saved as userData for each cylinder\nisAtractor,cylinders,scene){var orientation=new THREE.Matrix4();/* THREE.Object3D().up (=Y) default orientation for all objects */orientation.lookAt(startPoint,endPoint,new THREE.Object3D().up);/* rotation around axis X by -90 degrees\n   * matches the default orientation Y\n   * with the orientation of looking Z */var mat=new THREE.Matrix4();mat.set(1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1);orientation.multiply(mat);/* cylinder: radiusAtTop, radiusAtBottom, \n      height, radiusSegments, heightSegments */var edgeGeometry=new THREE.CylinderGeometry(upperRadius,lowerRadius,CYLINDER_HEIGHT,RADIAL_SEGMENTS,HEIGHT_SEGMENTS);var material=new THREE.MeshPhongMaterial({color:colorBacks,flatShading:true});var cylinder=new THREE.Mesh(edgeGeometry,material);cylinder.applyMatrix4(orientation);cylinder.position.set(midPoint.x,midPoint.y,midPoint.z);cylinder.cursor=\"pointer\";cylinder.userData.colorBacks=colorBacks;cylinder.userData.colorRank=colorRank;cylinder.userData.isAtractor=isAtractor;return cylinder;};export function createCylinder(data,// clustered data\nid,// id of current cluster\nstartPoint,// point A, for vector (A, B) giving cylinder its direction of rotation\nendPoint,// point B, for vector (A, B) described at startPoing\nupperRadius,lowerRadius,rank,rank_max,cylinders,texts,scene,description_div,nodes_ids,number_of_nodes){var isAtractor=data[id][\"Color\"]!==\"\";var colorBacks=new THREE.Color(isAtractor?data[id][\"Color\"]:calcColorBacks(data[id]));var colorRank=new THREE.Color(isAtractor?data[id][\"Color\"]:calcColorRank(rank_max,rank));var midPoint=new Point(// central point of cylinder <-> its position\n(startPoint.x+endPoint.x)/2,(startPoint.y+endPoint.y)/2,(startPoint.z+endPoint.z)/2);var cylinder=cylinderMesh(data,startPoint,endPoint,midPoint,upperRadius,lowerRadius,colorBacks,colorRank,isAtractor,cylinders,scene);cylinder.on(\"click\",function(){resetOpacity(cylinders);var newMaterial=cylinder.material.clone();newMaterial.transparent=true;newMaterial.opacity=0.5;cylinder.material=newMaterial;resetText(texts,scene);description_div.innerHTML=createDescriptionForCluster(data[id],cylinder,nodes_ids,number_of_nodes);});return cylinder;}","map":{"version":3,"names":["dec2bin","THREE","Point","GLTFExporter","NEUTRAL_COLOR","CYLINDER_HEIGHT","RADIAL_SEGMENTS","HEIGHT_SEGMENTS","resetOpacity","cylinders","forEach","cylinder","newMaterial","material","clone","transparent","opacity","resetText","texts","scene","text","selectedObject","getObjectByName","name","remove","getChildsChilds","data","cluster","childsChildCount","i","length","NodeCount","undefined","createCoordinatesForSingleSon","point","prevPoint","id","dirVector","Vector3","x","y","z","newStartPoint","newPoint","Object","freeze","createDescriptionForCluster","nodes_ids","number_of_nodes","elem","bin","atraktor","userData","isAtractor","calcColorBacks","calcColorRank","max","val","min","minHue","maxHue","curPercent","colString","crossProduct","a","b","save","blob","filename","link","document","createElement","style","display","body","appendChild","href","URL","createObjectURL","download","click","saveString","Blob","type","saveArrayBuffer","buffer","exportGLTE","input","gltfExporter","parse","result","ArrayBuffer","output","JSON","stringify","error","console","log","createControls","gui","group","parameters_colors","check","folder","addFolder","add","listen","onChange","e","setChecked","color","colorBacks","colorRank","Color","prop","param","params_export","export","exportGLTEObject","folder_export","params_move","right","moveObjectToRight","left","moveObjectToLeft","up","moveObjectUp","down","moveObjectDown","close","modeObjectCloser","far","moveObjectFar","folder_move","position","set","cylinderMesh","startPoint","endPoint","midPoint","upperRadius","lowerRadius","orientation","Matrix4","lookAt","Object3D","mat","multiply","edgeGeometry","CylinderGeometry","MeshPhongMaterial","flatShading","Mesh","applyMatrix4","cursor","createCylinder","rank","rank_max","description_div","on","innerHTML"],"sources":["/home/xkruzel/Desktop/todo/reactapp/src/rendering_utils.js"],"sourcesContent":["import { dec2bin } from './utils.js';\nimport * as THREE from \"three\";\nimport { Point } from \"./Point\";\nimport { GLTFExporter } from \"three/examples/jsm/exporters/GLTFExporter.js\";\n\nexport const NEUTRAL_COLOR = \"hsl(255, 0%, 46%)\";\nexport const CYLINDER_HEIGHT = 8;\nconst RADIAL_SEGMENTS = 8;\nconst HEIGHT_SEGMENTS = 1;\n\nfunction resetOpacity(cylinders) {\n    cylinders.forEach(function (cylinder) {\n        const newMaterial = cylinder.material.clone();\n        newMaterial.transparent = false;\n        newMaterial.opacity = 1;\n        cylinder.material = newMaterial;\n    });\n}\n  \nexport function resetText(texts, scene) {\n    texts.forEach(function (text) {\n      var selectedObject = scene.getObjectByName(text.name);\n      scene.remove(selectedObject);\n    });\n}\n  \nexport function getChildsChilds(data, cluster) {\n    var childsChildCount = 0;\n    for (var i = 0; i < cluster[\"Desc\"].length; ++i) {\n      childsChildCount += data[cluster[\"Desc\"][i]].NodeCount;\n    }\n  \n    if (cluster[\"Separate\"] !== undefined) {\n      childsChildCount = data[cluster[\"Separate\"]].NodeCount;\n    }\n  \n    return childsChildCount;\n}\n\nexport function createCoordinatesForSingleSon(point, prevPoint, id) {\n  const dirVector = new THREE.Vector3(\n    point.x - prevPoint.x,\n    point.y - prevPoint.y,\n    point.z - prevPoint.z\n  );\n\n  var newStartPoint = new Point(point.x, point.y, point.z); // to make copy\n  const newPoint = new Point(\n    dirVector.x + point.x,\n    dirVector.y + point.y,\n    dirVector.z + point.z\n  );\n\n  return Object.freeze({\n    id: id, //cluster[\"Desc\"][0],\n    prevPoint: newStartPoint,\n    point: newPoint,\n  });\n}\n\nexport function createDescriptionForCluster(cluster, cylinder, nodes_ids, number_of_nodes) {\n  var text = \"\";\n  cluster[\"Nodes\"].forEach(function (elem) {\n    if (text !== \"\") {\n      text += \",\";\n    }\n    text += \" (\";\n    const bin = dec2bin(elem, number_of_nodes);\n\n    for (let i = 0; i < bin.length; i++) {\n      if (bin[i] === \"1\") {\n        text += \" \" + nodes_ids[i];\n      }\n    }\n    text += \" )\";\n  });\n\n  const atraktor = cylinder.userData.isAtractor ? \"<br><b>Atraktor</b>\" : \"\";\n  return \"<b>Rank</b>: \" + cluster[\"Rank\"] + \"<br><b>Nodes</b>: \" + text + atraktor;\n}\n  \nexport function calcColorBacks(cluster) {\n  if (cluster[\"Backs\"].length > 0) {\n    return \"hsl(259, 20%, 30%)\";\n  }\n\n  return NEUTRAL_COLOR;\n}\n\nfunction calcColorRank(max, val) {\n  const min = 0\n  var minHue = 240, maxHue=0;\n  var curPercent = (val - min) / (max-min);\n  var colString = \"hsl(\" + ((curPercent * (maxHue-minHue) ) + minHue) + \",25%,40%)\";\n  return colString;\n}\n\nexport function crossProduct(a, b) {\n  return new THREE.Vector3(\n    a.y * b.z - a.z * b.y,\n    a.z * b.x - a.x * b.z,\n    a.x * b.y - a.y * b.x\n  );\n}\n\nexport function save( blob, filename ) {\n  const link = document.createElement( 'a' );\n  link.style.display = 'none';\n  document.body.appendChild( link );\n\n  link.href = URL.createObjectURL( blob );\n  link.download = filename;\n  link.click();\n\n  // URL.revokeObjectURL( url ); breaks Firefox...\n\n}\n\nexport function saveString( text, filename ) {\n\n  save( new Blob( [ text ], { type: 'text/plain' } ), filename );\n\n}\n\nexport function saveArrayBuffer( buffer, filename ) {\n\n  save( new Blob( [ buffer ], { type: 'application/octet-stream' } ), filename );\n\n}\n\nexport function exportGLTE(input) {\n  const gltfExporter = new GLTFExporter();\n  \n  gltfExporter.parse(\n    input,\n    function ( result ) {\n\n      if ( result instanceof ArrayBuffer ) {\n\n        saveArrayBuffer( result, 'object.glb' );\n\n      } else {\n\n        const output = JSON.stringify( result, null, 2 );\n        saveString( output, 'object.gltf' );\n\n      }\n\n    },\n    function ( error ) {\n\n      console.log( 'An error happened during parsing', error );\n\n    }\n  );\n};\n\nexport function createControls(\n  gui,\n  cylinders,\n  group\n) {\n\n  /* Colors */\n  var parameters_colors = [\n    {check: true  }, // color for back edges \n    {check: false }, // color for ranks\n    {check: false }, // color for None colors\n  ];\n\n  var folder = gui.addFolder(\"Colors\");\n  folder.add(parameters_colors[0], 'check').name('Back edges').listen().onChange(function(e)\n  {\n    setChecked(0);\n    if (e) {\n      cylinders.forEach(function(cylinder) {\n        if (!cylinder.userData.isAtractor) {\n          cylinder.material.color = cylinder.userData.colorBacks;\n        }\n      });\n    }\n  });\n\n  folder.add(parameters_colors[1], 'check').name('Ranks').listen().onChange(function(e)\n  {\n    setChecked(1);\n    if (e) {\n      cylinders.forEach(function(cylinder) {\n        if (!cylinder.userData.isAtractor) {\n          cylinder.material.color = cylinder.userData.colorRank;\n        }\n      });\n    }\n  });\n\n  folder.add(parameters_colors[2], 'check').name('None').listen().onChange(function(e)\n  {\n    setChecked(2);\n    if (e) {\n      cylinders.forEach(function(cylinder) {\n        if (!cylinder.userData.isAtractor) {\n          cylinder.material.color = new THREE.Color(NEUTRAL_COLOR);\n        }\n      });\n    }\n  });\n\n  function setChecked( prop ){\n    for (let param in parameters_colors){\n      parameters_colors[param].check = false;\n    }\n    parameters_colors[prop].check = true;\n  }\n\n  /* Export */\n  const params_export = {\n    export: exportGLTEObject,\n  };\n  var folder_export = gui.addFolder(\"Export\");\n\tfolder_export.add( params_export, 'export' ).name( 'Export in gltf format' );\n\n  /* Move */\n  const params_move = {\n    right: moveObjectToRight,\n    left:  moveObjectToLeft,\n    up:    moveObjectUp,\n    down:  moveObjectDown,\n    close: modeObjectCloser,\n    far:   moveObjectFar,\n  };\n  var folder_move = gui.addFolder(\"Move\");\n\tfolder_move.add( params_move, 'right' ).name( 'Move to right' );\n\tfolder_move.add( params_move, 'left' ).name( 'Move to left' );\n\tfolder_move.add( params_move, 'up' ).name( 'Move up' );\n\tfolder_move.add( params_move, 'down' ).name( 'Move down' );\n\tfolder_move.add( params_move, 'close' ).name( 'Move closer' );\n\tfolder_move.add( params_move, 'far' ).name( 'Move away' );\n\n  function moveObjectToRight() {\n    group.position.set(group.position.x + 5, group.position.y, group.position.z);\n  }\n\n  function moveObjectToLeft() {\n    group.position.set(group.position.x - 5, group.position.y, group.position.z);\n  }\n\n  function moveObjectUp() {\n    group.position.set(group.position.x, group.position.y + 5, group.position.z);\n  }\n\n  function moveObjectDown() {\n    group.position.set(group.position.x, group.position.y - 5, group.position.z);\n  }\n\n  function modeObjectCloser() {\n    group.position.set(group.position.x, group.position.y, group.position.z + 5);\n  }\n\n  function moveObjectFar() {\n    group.position.set(group.position.x, group.position.y, group.position.z - 5);\n  }\n\n  function exportGLTEObject() {\n    return exportGLTE(group);\n  }\n\n}\n\nfunction cylinderMesh (\n  data,\n  startPoint,    // point A, for vector (A, B) giving cylinder its direction of rotation\n  endPoint,      // point B, for vector (A, B) described at startPoint\n  midPoint,      // position of mesh\n  upperRadius,\n  lowerRadius,\n  colorBacks,    // color for back variation of coloring\n  colorRank,     // color for rank variation of coloring - with colorBacks saved as userData for each cylinder\n  isAtractor,\n  cylinders,\n  scene\n) {\n\n  const orientation = new THREE.Matrix4();\n  /* THREE.Object3D().up (=Y) default orientation for all objects */\n  orientation.lookAt(startPoint, endPoint, new THREE.Object3D().up);\n\n  /* rotation around axis X by -90 degrees\n   * matches the default orientation Y\n   * with the orientation of looking Z */\n  const mat = new THREE.Matrix4();\n  mat.set(1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1);\n  orientation.multiply(mat);\n\n  /* cylinder: radiusAtTop, radiusAtBottom, \n      height, radiusSegments, heightSegments */\n\n  const edgeGeometry = new THREE.CylinderGeometry(\n    upperRadius,\n    lowerRadius,\n    CYLINDER_HEIGHT,\n    RADIAL_SEGMENTS,\n    HEIGHT_SEGMENTS\n  );\n\n  const material = new THREE.MeshPhongMaterial({ color: colorBacks, flatShading: true });\n  const cylinder = new THREE.Mesh(\n    edgeGeometry,\n    material\n  );\n\n  cylinder.applyMatrix4(orientation);\n  cylinder.position.set(midPoint.x, midPoint.y, midPoint.z);\n  cylinder.cursor = \"pointer\";\n\n  cylinder.userData.colorBacks = colorBacks;\n  cylinder.userData.colorRank  = colorRank;\n  cylinder.userData.isAtractor = isAtractor;\n\n  return cylinder;\n};\n\nexport function createCylinder(\n  data,           // clustered data\n  id,             // id of current cluster\n  startPoint,     // point A, for vector (A, B) giving cylinder its direction of rotation\n  endPoint,       // point B, for vector (A, B) described at startPoing\n  upperRadius,\n  lowerRadius,\n  rank,\n  rank_max,\n  cylinders,\n  texts,\n  scene,\n  description_div,\n  nodes_ids,\n  number_of_nodes\n) {\n\n  const isAtractor = data[id][\"Color\"] !== \"\";\n  const colorBacks = new THREE.Color(\n    isAtractor ? data[id][\"Color\"] : calcColorBacks(data[id])\n  );\n  const colorRank = new THREE.Color(\n    isAtractor ? data[id][\"Color\"] : calcColorRank(rank_max, rank)\n  );\n\n  const midPoint = new Point(     // central point of cylinder <-> its position\n    (startPoint.x + endPoint.x) / 2,\n    (startPoint.y + endPoint.y) / 2,\n    (startPoint.z + endPoint.z) / 2\n  );\n\n  var cylinder = cylinderMesh(\n    data,\n    startPoint,\n    endPoint,\n    midPoint,\n    upperRadius,\n    lowerRadius,\n    colorBacks,\n    colorRank,\n    isAtractor,\n    cylinders,\n    scene\n  );\n\n  cylinder.on(\"click\", function () {\n    resetOpacity(cylinders);\n    const newMaterial = cylinder.material.clone();\n    newMaterial.transparent = true;\n    newMaterial.opacity = 0.5;\n    cylinder.material = newMaterial;\n\n    resetText(texts, scene);\n    description_div.innerHTML = createDescriptionForCluster(data[id], cylinder, nodes_ids, number_of_nodes);\n  });\n\n  return cylinder;\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}